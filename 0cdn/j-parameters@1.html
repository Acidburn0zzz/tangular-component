<style>.ui-parameters{font-size:11px;border:1px solid #E0E0E0}.ui-parameters-search{height:30px;background-color:white;font-size:12px;border-bottom:1px solid #E0E0E0}.ui-parameters-search span{float:left;width:30px;line-height:30px;text-align:center}.ui-parameters-search .fa-times{color:red;cursor:pointer}.ui-parameters-search div{margin-left:30px}.ui-parameters-search input{width:100%;border:0;outline:0;background:transparent;font-size:12px;height:30px}.ui-parameters-modified{font-weight:bold}.ui-parameters-item{height:24px;font-size:11px;border-bottom:1px solid #E0E0E0}.ui-parameters-name{float:left;width:40%;line-height:23px;padding:0 5px;text-overflow:ellipsis;overflow:hidden;text-overflow:ellipsis}.ui-parameters-type{float:left;width:20%;line-height:23px;padding:0 5px;text-overflow:ellipsis;overflow:hidden;text-overflow:ellipsis;border-left:1px solid #E0E0E0;border-right:1px solid #E0E0E0;color:gray;background-color:#F9F9F9}.ui-parameters-value{float:left;width:40%;padding:0 5px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.ui-parameters-value div{display:block;line-height:23px}.ui-parameters-value input{border:0;background:transparent;width:100%;outline:0;height:23px;font-size:11px}.ui-parameters-boolean{cursor:pointer}.ui-dark .ui-parameters-search span{color:gray}.ui-dark .ui-parameters-search{background-color:#252525;border-bottom-color:#404040}.ui-dark .ui-parameters{border-color:#404040}.ui-dark .ui-parameters-modified{color:white}.ui-dark .ui-parameters-item{border-bottom-color:#404040}.ui-dark .ui-parameters-type{background-color:#282828;border-left-color:#404040;border-right-color:#404040}</style>
<script>COMPONENT('parameters@1','search:Search;dateformat:yyyy-MM-dd;offset:5',function(self,config){var cls='ui-parameters',cls2='.ui-parameters',container,search,scroller,prevh,skip;self.readonly();self.init=function(){Thelpers.ui_parameters_value=function(val,format){if(val instanceof Date)return val.format(format)if(typeof(val)==='number')return val;return val?Thelpers.encode(val.toString()):''}};self.template=Tangular.compile('<div class="{0}-item{{ if modified}} {0}-modified{{ fi}}" data-index="{{ $.index}}" data-search="{{ $.search}}"><div class="{0}-name">{{ name}}</div><div class="{0}-type">{{ type}}</div><div class="{0}-value">{{ if type === \'boolean\' }}<div class="{0}-boolean">{{ if value}}true{{ else}}false{{ fi}}</div>{{ else}}<input class="{0}-input" value="{{ value | ui_parameters_value(\'{1}\') }}" />{{ fi}}</div></div>'.format(cls,config.dateformat));self.search=function(){var val=search.find('input').val().toSearch();search.find('i').rclass('fa-').tclass('fa-search',!val).tclass('fa-times',!!val);self.find(cls2+'-item').each(function(){var el=$(this);el.tclass('hidden',val?el.attrd('search').indexOf(val)===-1:false)});self.scrollbar.resize()};self.resize=function(){var h=0;if(config.height>0)h=config.height;else if(config.parent)h=(config.parent==='window'?WH:config.parent==='parent'?self.parent().height():self.closest(config.parent).height())-search.height()-self.element.offset().top-config.offset;if(prevh===h)return;prevh=h;scroller.css('height',h);self.scrollbar.resize()};self.make=function(){self.aclass(cls);self.append('<div class="{0}-search"><span><i class="fa fa-search"></i></span><div><input type="text" placeholder="{1}" maxlength="50" class="{0}-searchinput" /></div></div><div class="{0}-scroller"><div class="{0}-container"></div></div>'.format(cls,config.search));container=self.find(cls2+'-container');search=self.find(cls2+'-search');scroller=self.find(cls2+'-scroller');self.scrollbar=SCROLLBAR(scroller);search.on('keydown',cls2+'-searchinput',function(e){setTimeout2(self.ID,self.search,300)});search.on('click','.fa-times',function(){search.find('input').val('');self.search()});container.on('dblclick',cls2+'-boolean',function(){var el=$(this).parent();var row=el.closest(cls2+'-item');var index=+row.attrd('index');var item=self.get()[index];var indexer={index:index,search:item.name.toSearch()};skip=true;item.value=!item.value;item.modified=item.prev!==item.value;row.replaceWith(self.template(item,indexer));item.modified&&self.change(true);UPD(self.path,2)});container.on('change',cls2+'-input',function(){var el=$(this);var row=el.closest(cls2+'-item');var index=+row.attrd('index');var item=self.get()[index];var indexer={index:index,search:item.name.toSearch()};item.value=el.val();switch(item.type){case'date':item.value=item.value?item.value.parseDate(config.dateformat):null;if(item.value&&isNaN(item.value.getTime()))item.value=item.prev;var a=item.value?item.value.format(config.dateformat):0;var b=item.prev?item.prev.format(config.dateformat):0;item.modified=a!==b;break;case'number':item.value=item.value.parseFloat();item.modified=item.value!==item.prev;break;default:item.modified=item.value!==item.prev;break}row.replaceWith(self.template(item,indexer));item.modified&&self.change(true);skip=true;UPD(self.path,2)});self.on('resize',self.resize);self.resize();self.scrollbar.resize()};self.setter=function(value,path,type){if(skip){skip=false;return}var builder=[],indexer={};for(var i=0;i<value.length;i++){var item=value[i];indexer.index=i;indexer.search=item.name.toSearch();item.prev=item.type==='date'&&item.value?item.value.format(config.dateformat):item.value;builder.push(self.template(item,indexer))}container.html(builder.join(''));self.search();self.resize()}});</script>